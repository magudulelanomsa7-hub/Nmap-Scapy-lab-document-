Nmap & Scapy Lab Documentation

A Professional GitHub‑Ready Report

This repository documents the full reproduction of Nmap and Scapy practical exercises conducted within the ParoCyber internal training network. All activities were performed for educational and authorized assessment purposes only.




 1. Objective

The purpose of this lab was to practice and document core reconnaissance and packet‑level analysis techniques used in penetration testing. The exercises covered:

Network host discovery

Service and version enumeration

OS fingerprinting

SMB scanning and share enumeration

Packet crafting

Packet sniffing and protocol analysis

Traffic capture for offline examination


This documentation presents all steps and results in a clear, professional, and reproducible format.




 2. Lab Environment

Component	Details

Operating System	Kali Linux
Tools Used	Nmap, Scapy, tcpdump, smbclient
Network Range	10.6.6.0/24
Target Host	10.6.6.23
Interface Used	br-internal / eth0
Lab Type	Internal ParoCyber Training Network





 NMAP LAB WORK

Below is the full breakdown of Nmap tasks completed during the assessment process.

1. Host Discovery

nmap -sn 10.6.6.0/24

This scan performed an ARP and ICMP-based sweep to identify responsive hosts on the subnet. The output allowed for confirmation of active machines before performing deeper enumeration.



2. Operating System Fingerprinting

sudo nmap -O 10.6.6.23

This command attempted to determine the target system's operating system using stack fingerprinting and behavioral patterns. Accuracy varies depending on host response and firewall configuration.


---

3. Aggressive Service Scan on FTP (Port 21)

nmap -p21 -sV -A -T4 10.6.6.23

This scan combined service version detection, OS probing, script execution, and traceroute to gather maximum information from port 21. Results typically reveal banner details, service versions, and additional metadata.




4. SMB Enumeration on Ports 139 and 445

nmap -A -p139,445 10.6.6.23

This scan focused on SMB-related ports to identify services, supported dialects, and potential OS information returned via SMB negotiation.




5. SMB Share Enumeration via NSE

nmap --script smb-enum-shares.nse -p445 10.6.6.23

The Nmap Scripting Engine (NSE) was used to enumerate shared folders on the target SMB service. This script helps identify accessible shares and potential misconfigurations.




6. SMB Access Verification

smbclient //10.6.6.23/print$ -N

SMB access was validated manually using smbclient to confirm the results obtained from the Nmap scan and to explore share contents where possible.

7. Network Context Commands Used

These commands were executed to gather supporting environmental information:

ifconfig
ip route
cat /etc/resolv.conf

ifconfig → verified IPs, interfaces, and link state

ip route → examined routing and gateway configuration

resolv.conf → checked DNS resolver settings




8. Packet Capture with tcpdump

sudo tcpdump -i eth0 -s 0 -w ladies.pcap

This captured all packets traversing the interface for later analysis in Wireshark or similar tools.

Capture stopped with CTRL + C

File verified using:


ls ladies.pcap



 SCAPY LAB WORK

Scapy was used to observe, filter, and analyze live traffic on the internal network.

1. Launching Scapy

sudo su
scapy

Scapy requires elevated permissions to send and capture raw packets.



2. Basic Packet Sniffing

sniff()

A general packet capture was initiated to observe network activity. While Scapy sniffed traffic, ICMP traffic was generated using:

ping google.com

Captured packets were stored:

paro = _
paro.summary()



3. Interface-Specific Sniffing

sniff(iface="br-internal")

Additional traffic was generated by:

Pinging a gateway: ping 10.6.6.1

Visiting the internal service: 10.6.6.23


Captured packets were saved:

paro2 = _
paro2.summary()




4. ICMP-Specific Filtering

sniff(iface="br-internal", filter="icmp", count=5)

This captured exactly five ICMP packets. ICMP was generated using:

ping 10.6.6.23

Storing and reviewing packets:

paro3 = _
paro3.summary()
paro3[3]

This allowed packet‑level inspection including headers, flags, and payloads.




 Summary of Findings

Nmap Results

Successfully identified active hosts

Performed comprehensive enumeration of FTP and SMB services

Conducted OS fingerprinting attempts with varying confidence

Discovered available SMB shares and validated access


Scapy Results

Captured live packets on multiple interfaces

Filtered and analyzed ICMP traffic

Observed internal web traffic and ARP activity

Inspected captured packets at a granular level


tcpdump Contribution

Generated a full .pcap file for later Wireshark analysis

Provided a reliable capture of all Nmap and Scapy activity



 Conclusion

This lab demonstrated practical skills essential to network scanning, enumeration, and packet analysis. Through the combined use of Nmap, Scapy, and tcpdump, a comprehensive understanding of host behavior, protocol communication, and traffic patterns was achieved. These techniques form the foundation of professional penetration testing, network troubleshooting, and security analysis.

